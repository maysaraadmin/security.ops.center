- name: Suspicious Process Execution
  description: Detects execution of potentially malicious processes from suspicious
    locations
  severity: HIGH
  enabled: true
  tags:
  - process
  - execution
  - suspicious
  condition:
    process_name:
    - powershell.exe
    - cmd.exe
    - wscript.exe
    - cscript.exe
    - mshta.exe
    process_path:
    - '%TEMP%'
    - '%APPDATA%'
    - '%LOCALAPPDATA%'
    - \Windows\Temp
  action: alert
  rule_id: PROC-001
  detection_type: signature
- name: Unusual Parent-Process Relationship
  description: Detects processes with unusual parent-child relationships
  severity: MEDIUM
  enabled: true
  tags:
  - process
  - parent-child
  - behavior
  condition:
    parent_process:
    - explorer.exe
    - iexplore.exe
    - chrome.exe
    - firefox.exe
    child_process:
    - powershell.exe
    - cmd.exe
    - wscript.exe
  action: alert
  rule_id: PROC-002
  detection_type: signature
- name: Suspicious Outbound Connection
  description: Detects outbound connections to known malicious IPs or unusual ports
  severity: HIGH
  enabled: true
  tags:
  - network
  - connection
  - suspicious
  condition:
    remote_ip:
    - '*.*.*.*'
    remote_port:
    - '4444'
    - '8080'
    - '53'
    process_name:
    - powershell.exe
    - cmd.exe
    - wscript.exe
  action: block
  rule_id: NET-001
  detection_type: signature
- name: DNS Tunneling Attempt
  description: Detects potential DNS tunneling activity
  severity: MEDIUM
  enabled: true
  tags:
  - network
  - dns
  - exfiltration
  condition:
    protocol:
    - udp
    remote_port:
    - '53'
    query_length: '> 100'
  action: alert
  rule_id: NET-002
  detection_type: signature
- name: Suspicious File Creation
  description: Detects creation of potentially malicious files
  severity: MEDIUM
  enabled: true
  tags:
  - file
  - creation
  - suspicious
  condition:
    file_extension:
    - .js
    - .jse
    - .vbs
    - .vbe
    - .wsf
    - .wsh
    - .ps1
    - .psm1
    file_path:
    - '%TEMP%'
    - '%APPDATA%'
    - '%LOCALAPPDATA%'
  action: quarantine
  rule_id: FILE-001
  detection_type: signature
- name: System File Modification
  description: Detects unauthorized modification of system files
  severity: HIGH
  enabled: true
  tags:
  - file
  - modification
  - system
  condition:
    file_path:
    - '%SYSTEMROOT%\System32'
    - '%SYSTEMROOT%\SysWOW64'
    operation:
    - write
    - delete
  action: alert
  rule_id: FILE-002
  detection_type: signature
- name: Code Injection Detected
  description: Detects potential code injection into another process
  severity: HIGH
  enabled: true
  tags:
  - memory
  - injection
  - exploit
  condition:
    source_process:
    - '*.*'
    target_process:
    - lsass.exe
    - svchost.exe
    - explorer.exe
    operation:
    - VirtualAllocEx
    - WriteProcessMemory
    - CreateRemoteThread
  action: terminate
  rule_id: MEM-001
  detection_type: signature
- name: Persistence Mechanism
  description: Detects registry modifications used for persistence
  severity: HIGH
  enabled: true
  tags:
  - registry
  - persistence
  - autorun
  condition:
    key_path:
    - HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
    - HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
    - HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
    - HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce
    operation:
    - create
    - set_value
  action: alert
  rule_id: REG-001
  detection_type: signature
- name: Process Hollowing
  description: Detects potential process hollowing technique
  severity: CRITICAL
  enabled: true
  tags:
  - behavior
  - injection
  - evasion
  condition:
    process_creation: true
    process_termination: < 5s
    child_process: true
  action: terminate
  rule_id: BEH-001
  detection_type: behavioral
- name: Credential Dumping
  description: Detects potential credential dumping activity
  severity: CRITICAL
  enabled: true
  tags:
  - behavior
  - credential_access
  condition:
    process_name:
    - lsass.exe
    operation:
    - OpenProcess
    - ReadProcessMemory
    source_process:
    - '*.*'
  action: terminate
  rule_id: BEH-002
  detection_type: behavioral
